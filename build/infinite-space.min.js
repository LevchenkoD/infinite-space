function throttle(t,e){var i=Date.now();return function(){i+e-Date.now()<0&&(t(),i=Date.now())}}function calculateDrag(t){var e=t.position[1]+t.elementMarginTop,i=t.position[0]+t.elementMarginLeft,s=t.elementPosition.left/t.scale,n=t.elementPosition.top/t.scale,o=s+t.elementWidth,a=n+t.elementHeight,h=t.contentPosition.left/t.scale,l=t.contentPosition.top/t.scale,c=t.lastPosition[1]>t.position[1],r=l+e,p=c&&t.fakeContentPosition.top+r<=t.edgeDistance+t.padding.top,d=c&&l-t.scrollTop/t.scale+n<=t.edgeDistance+t.padding.top,g=t.lastPosition[1]<t.position[1],f=t.fakeContentPosition.top+t.fakeContentHeight-l-a,w=g&&t.edgeDistance>=f,u=g&&t.scrollTop/t.scale+t.wrapperHeight/t.scale-(t.position[1]+l+t.elementHeight)-t.elementMarginTop<t.edgeDistance,m=t.lastPosition[0]>t.position[0],D=h+i,C=m&&t.fakeContentPosition.left+D<=t.edgeDistance+t.padding.left,M=m&&h-t.scrollLeft/t.scale+s<=t.edgeDistance+t.padding.left,T=t.lastPosition[0]<t.position[0],k=t.fakeContentPosition.left+t.fakeContentWidth-h-o;return{adjustTop:p,scrollToTop:d,adjustBottom:w,scrollToBottom:u,adjustLeft:C,scrollToLeft:M,leftDistance:D,adjustRight:T&&t.edgeDistance>=k,scrollToRight:T&&t.scrollLeft/t.scale+t.wrapperWidth/t.scale-(t.position[0]+h+t.elementWidth)-t.elementMarginLeft<t.edgeDistance}}"undefined"!=typeof module&&null!=module.exports&&(exports.calculateDrag=calculateDrag),function(t){"use strict";var e=function(t){this.defaultData={wrapper:".wrapper",fakeContent:".scroll-fake-content",content:".content",throttleMs:200,edgeDistance:100,scrollStep:100,fakeContentSize:null,scale:1,lastPosition:[0,0],getMaxTop:function(){return 1e4},getMaxLeft:function(){return 1e4},getMaxRight:function(){return 1e4},getMaxBottom:function(){return 1e4}},this.init(t)};e.prototype.centerContent=function(){var t,e,i=(t=this.$fakeContent,{x:((e=this.fakeContentSize)?e.width:t.width())/2,y:(e?e.height:t.height())/2}),s=this.contentSize?this.contentSize.width:this.$content.width(),n=this.contentSize?this.contentSize.height:this.$content.height(),o=i.x-s/2,a=i.y-n/2;this.fakeContentSize&&this.$fakeContent.css({width:this.fakeContentSize.width,height:this.fakeContentSize.height}),this.$content.css({left:o,top:a,width:s,height:n})},e.prototype.handleDrag=function(e,i){var s=(new Date).getTime();if(!(s-this.lastCall<this.throttleMs)){var n=this.isBody?t(window).width():this.$wrapper.width(),o=this.isBody?t(window).height():this.$wrapper.height(),a=this.$fakeContent.position(),h=this.$fakeContent.width(),l=this.$fakeContent.height(),c=t(i).width(),r=t(i).height(),p=t(i).position(),d=this.isBody?window:this.wrapper,g=Math.max(d.scrollLeft||d.scrollX),f=Math.max(d.scrollTop||d.scrollY),w=this.$content.position(),u=this.$content.width(),m=this.$content.height(),D=calculateDrag({position:e,lastPosition:this.lastPosition,scale:this.scale,edgeDistance:this.edgeDistance,padding:this.padding,scrollLeft:g,scrollTop:f,wrapperWidth:n,wrapperHeight:o,contentPosition:w,contentWidth:u,contentHeight:m,fakeContentPosition:a,fakeContentWidth:h,fakeContentHeight:l,elementPosition:p,elementHeight:r,elementWidth:c,elementMarginTop:this.elementMarginTop,elementMarginLeft:this.elementMarginLeft});if(this.lastPosition=e||[0,0],this.lastCall=s,!this.disallowNegativePosition&&D.adjustTop){var C,M=this.$fakeContent.height();this.$fakeContent.height(M+this.edgeDistance/this.scale),this.$content.css({top:this.$content.position().top/this.scale+this.edgeDistance/this.scale}),C=this.elementMarginTop-this.edgeDistance/this.scale,t(i).css({marginTop:C}),this.elementMarginTop=C}if(D.scrollToTop&&d.scrollTo(g,f-this.scrollStep+(D.adjustTop?this.edgeDistance:0)),!this.disallowNegativePosition&&D.adjustLeft){var T,k=this.$fakeContent.width();this.$fakeContent.width(k+this.edgeDistance/this.scale),this.$content.css({left:this.$content.position().left/this.scale+this.edgeDistance/this.scale}),T=this.elementMarginLeft-this.edgeDistance/this.scale,t(i).css({marginLeft:T}),this.elementMarginLeft=T}D.scrollToLeft&&d.scrollTo(g-(this.scrollStep+(D.adjustLeft?this.edgeDistance:0)),f),D.adjustRight&&this.$fakeContent.width(this.$fakeContent.width()+2*this.edgeDistance),D.scrollToRight&&d.scrollTo(g+this.scrollStep,f),D.adjustBottom&&this.$fakeContent.height(this.$fakeContent.height()+this.edgeDistance),D.scrollToBottom&&d.scrollTo(g,f+this.scrollStep)}},e.prototype.update=function(t){this.scale=t.scale||this.scale},e.prototype.handleDrop=function(e){var i=t(e),s=i.position(),n=s.top+this.elementMarginTop,o=s.left+this.elementMarginLeft,a=this.isBody?window:this.wrapper,h=Math.max(a.scrollLeft||a.scrollX),l=Math.max(a.scrollTop||a.scrollY);i.css({top:n,left:o,marginTop:0,marginLeft:0}),this.elementMarginTop=0,this.elementMarginLeft=0,this.onChange({content:{size:{width:this.$content.width(),height:this.$content.height()},position:this.$content.position()},fakeContent:{size:{width:this.$fakeContent.width(),height:this.$fakeContent.height()},position:this.$fakeContent.position()},wrapper:{size:{width:this.$wrapper.width(),height:this.$wrapper.height()},position:this.$wrapper.position()},scale:this.scale,scroll:{left:h,top:l}})},e.prototype.init=function(e){var i,s;return this.data=e||this.defaultData,this.$wrapper=t(this.data.wrapper||this.defaultData.wrapper),this.wrapper=this.$wrapper[0],this.isBody="BODY"===this.wrapper.tagName,this.$fakeContent=t(this.data.fakeContent||this.defaultData.fakeContent),this.$content=t(this.data.content||this.defaultData.content),this.lastScrollTop=this.wrapper.scrollTop,this.lastScrollLeft=this.wrapper.scrollLeft,this.edgeDistance=this.data.edgeDistance||this.defaultData.edgeDistance,this.scrollStep=this.data.scrollStep||this.defaultData.scrollStep,this.throttleMs=this.data.throttleMs||this.defaultData.throttleMs,this.getMaxTop=this.data.getMaxTop||this.defaultData.getMaxTop,this.getMaxLeft=this.data.getMaxLeft||this.defaultData.getMaxLeft,this.getMaxRight=this.data.getMaxRight||this.defaultData.getMaxRight,this.getMaxBottom=this.data.getMaxBottom||this.defaultData.getMaxBottom,this.fakeContentSize=this.data.fakeContentSize||this.defaultData.fakeContentSize,this.contentSize=this.data.contentSize||this.defaultData.contentSize,this.scale=this.data.scale||this.defaultData.scale,this.disallowNegativePosition="boolean"==typeof this.data.disallowNegativePosition&&this.data.disallowNegativePosition,this.padding={top:0,left:0},"object"==typeof e.padding&&("number"==typeof e.padding.top&&(this.padding.top=e.padding.top),"number"==typeof e.padding.left&&(this.padding.left=e.padding.left)),this.onChange="function"==typeof this.data.onChange?this.data.onChange:function(){},this.elementMarginTop=0,this.elementMarginLeft=0,this.centerContent(),this.centers=(i=this.wrapper,s="BODY"===i.tagName,{x:i.scrollWidth/2-t(s?window:i).width()/2,y:i.scrollHeight/2-t(s?window:i).height()/2}),this.lastCenters=this.centers,this.lastPosition=[0,0],this.lastCall=(new Date).getTime(),(this.isBody?document.documentElement:this.wrapper).scrollTo(this.lastCenters.x,this.lastCenters.y),this},window.InfiniteSpace=e}(jQuery);