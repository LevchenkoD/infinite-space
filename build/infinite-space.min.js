function throttle(t,e){var i=Date.now();return function(){i+e-Date.now()<0&&(t(),i=Date.now())}}function calculateDrag(t){var e=t.position[1]+t.elementMarginTop,i=t.position[0]+t.elementMarginLeft,n=t.elementPosition.left/t.scale,s=t.elementPosition.top/t.scale,o=n+t.elementWidth,a=s+t.elementHeight,h=t.contentPosition.left/t.scale,l=t.contentPosition.top/t.scale,c=t.lastPosition[1]>t.position[1],r=l+e,p=c&&t.fakeContentPosition.top+r<=t.edgeDistance+t.padding.top,d=c&&l-t.scrollTop/t.scale+s<=t.edgeDistance+t.padding.top,f=t.lastPosition[1]<t.position[1],g=t.fakeContentPosition.top+t.fakeContentHeight-l-a,w=f&&t.edgeDistance>=g,u=f&&t.scrollTop/t.scale+t.wrapperHeight/t.scale-(t.position[1]+l+t.elementHeight)-t.elementMarginTop<t.edgeDistance,C=t.lastPosition[0]>t.position[0],m=h+i,D=C&&t.fakeContentPosition.left+m<=t.edgeDistance+t.padding.left,k=C&&h-t.scrollLeft/t.scale+n<=t.edgeDistance+t.padding.left,$=t.lastPosition[0]<t.position[0],M=t.fakeContentPosition.left+t.fakeContentWidth-h-o;return{adjustTop:p,scrollToTop:d,adjustBottom:w,scrollToBottom:u,adjustLeft:D,scrollToLeft:k,leftDistance:m,adjustRight:$&&t.edgeDistance>=M,scrollToRight:$&&t.scrollLeft/t.scale+t.wrapperWidth/t.scale-(t.position[0]+h+t.elementWidth)-t.elementMarginLeft<t.edgeDistance}}"undefined"!=typeof module&&null!=module.exports&&(exports.calculateDrag=calculateDrag),function(t){"use strict";var e=function(t){this.defaultData={wrapper:".wrapper",fakeContent:".scroll-fake-content",content:".content",throttleMs:200,edgeDistance:100,scrollStep:100,fakeContentSize:null,scale:1,lastPosition:[0,0],getMaxTop:function(){return 1e4},getMaxLeft:function(){return 1e4},getMaxRight:function(){return 1e4},getMaxBottom:function(){return 1e4}},this.init(t)};e.prototype.centerContent=function(){var t,e,i=(t=this.$fakeContent,{x:((e=this.fakeContentSize)?e.width:t.width())/2,y:(e?e.height:t.height())/2}),n=this.contentSize?this.contentSize.width:this.$content.width(),s=this.contentSize?this.contentSize.height:this.$content.height(),o=i.x-n/2,a=i.y-s/2;this.fakeContentSize&&this.$fakeContent.css({width:this.fakeContentSize.width,height:this.fakeContentSize.height}),this.$content.css({left:o,top:a,width:n,height:s})},e.prototype.handleDrag=function(e,i){var n=(new Date).getTime();if(!(n-this.lastCall<this.throttleMs)){var s=this.isBody?t(window).width():this.$wrapper.width(),o=this.isBody?t(window).height():this.$wrapper.height(),a=this.$fakeContent.position(),h=this.$fakeContent.width(),l=this.$fakeContent.height(),c=t(i).width(),r=t(i).height(),p=t(i).position(),d=this.isBody?window:this.wrapper,f=Math.max(d.scrollLeft||d.scrollX),g=Math.max(d.scrollTop||d.scrollY),w=this.$content.position(),u=this.$content.width(),C=this.$content.height(),m=calculateDrag({position:e,lastPosition:this.lastPosition,scale:this.scale,edgeDistance:this.edgeDistance,padding:this.padding,scrollLeft:f,scrollTop:g,wrapperWidth:s,wrapperHeight:o,contentPosition:w,contentWidth:u,contentHeight:C,fakeContentPosition:a,fakeContentWidth:h,fakeContentHeight:l,elementPosition:p,elementHeight:r,elementWidth:c,elementMarginTop:this.elementMarginTop,elementMarginLeft:this.elementMarginLeft});if(this.lastPosition=e||[0,0],this.lastCall=n,!this.disallowNegativePosition&&m.adjustTop){var D,k=this.$fakeContent.height();this.$fakeContent.height(k+this.edgeDistance/this.scale),this.$content.css({top:this.$content.position().top/this.scale+this.edgeDistance/this.scale}),D=this.elementMarginTop-this.edgeDistance/this.scale,t(i).css({marginTop:D}),this.elementMarginTop=D}if(m.scrollToTop&&d.scrollTo(f,g-this.scrollStep+(m.adjustTop?this.edgeDistance:0)),!this.disallowNegativePosition&&m.adjustLeft){var $,M=this.$fakeContent.width();this.$fakeContent.width(M+this.edgeDistance/this.scale),this.$content.css({left:this.$content.position().left/this.scale+this.edgeDistance/this.scale}),$=this.elementMarginLeft-this.edgeDistance/this.scale,t(i).css({marginLeft:$}),this.elementMarginLeft=$}m.scrollToLeft&&d.scrollTo(f-(this.scrollStep+(m.adjustLeft?this.edgeDistance:0)),g),m.adjustRight&&this.$fakeContent.width(this.$fakeContent.width()+2*this.edgeDistance),m.scrollToRight&&d.scrollTo(f+this.scrollStep,g),m.adjustBottom&&this.$fakeContent.height(this.$fakeContent.height()+this.edgeDistance),m.scrollToBottom&&d.scrollTo(f,g+this.scrollStep)}},e.prototype.update=function(t){this.scale=t.scale||this.scale,this.fakeContentSize=t.fakeContentSize||this.$fakeContent.size(),this.fakeContentPosition=t.fakeContentPosition||this.$fakeContent.position(),this.contentSize=t.contentSize||this.$content.size(),this.contentPosition=t.contentPosition||this.$content.position(),this.$content.css({top:this.contentPosition.top,left:this.contentPosition.left,height:this.contentSize.height,width:this.contentSize.width}),this.$fakeContent.css({top:this.fakeContentPosition.top,left:this.fakeContentPosition.left,height:this.fakeContentSize.height,width:this.fakeContentSize.width})},e.prototype.handleDrop=function(e){var i=t(e),n=i.position(),s=n.top+this.elementMarginTop,o=n.left+this.elementMarginLeft,a=this.isBody?window:this.wrapper,h=Math.max(a.scrollLeft||a.scrollX),l=Math.max(a.scrollTop||a.scrollY);i.css({top:s,left:o,marginTop:0,marginLeft:0}),this.elementMarginTop=0,this.elementMarginLeft=0,this.onChange({content:{size:{width:this.$content.width(),height:this.$content.height()},position:this.$content.position()},fakeContent:{size:{width:this.$fakeContent.width(),height:this.$fakeContent.height()},position:this.$fakeContent.position()},wrapper:{size:{width:this.$wrapper.width(),height:this.$wrapper.height()},position:this.$wrapper.position()},scale:this.scale,scroll:{left:h,top:l}})},e.prototype.init=function(e){var i,n;return this.data=e||this.defaultData,this.$wrapper=t(this.data.wrapper||this.defaultData.wrapper),this.wrapper=this.$wrapper[0],this.isBody="BODY"===this.wrapper.tagName,this.$fakeContent=t(this.data.fakeContent||this.defaultData.fakeContent),this.$content=t(this.data.content||this.defaultData.content),this.lastScrollTop=this.wrapper.scrollTop,this.lastScrollLeft=this.wrapper.scrollLeft,this.edgeDistance=this.data.edgeDistance||this.defaultData.edgeDistance,this.scrollStep=this.data.scrollStep||this.defaultData.scrollStep,this.throttleMs=this.data.throttleMs||this.defaultData.throttleMs,this.getMaxTop=this.data.getMaxTop||this.defaultData.getMaxTop,this.getMaxLeft=this.data.getMaxLeft||this.defaultData.getMaxLeft,this.getMaxRight=this.data.getMaxRight||this.defaultData.getMaxRight,this.getMaxBottom=this.data.getMaxBottom||this.defaultData.getMaxBottom,this.fakeContentSize=this.data.fakeContentSize||this.defaultData.fakeContentSize,this.contentSize=this.data.contentSize||this.defaultData.contentSize,this.scale=this.data.scale||this.defaultData.scale,this.disallowNegativePosition="boolean"==typeof this.data.disallowNegativePosition&&this.data.disallowNegativePosition,this.padding={top:0,left:0},"object"==typeof e.padding&&("number"==typeof e.padding.top&&(this.padding.top=e.padding.top),"number"==typeof e.padding.left&&(this.padding.left=e.padding.left)),this.onChange="function"==typeof this.data.onChange?this.data.onChange:function(){},this.elementMarginTop=0,this.elementMarginLeft=0,this.centerContent(),this.centers=(i=this.wrapper,n="BODY"===i.tagName,{x:i.scrollWidth/2-t(n?window:i).width()/2,y:i.scrollHeight/2-t(n?window:i).height()/2}),this.lastCenters=this.centers,this.lastPosition=[0,0],this.lastCall=(new Date).getTime(),(this.isBody?document.documentElement:this.wrapper).scrollTo(this.lastCenters.x,this.lastCenters.y),this},window.InfiniteSpace=e}(jQuery);