function throttle(t,e){var i=Date.now();return function(){i+e-Date.now()<0&&(t(),i=Date.now())}}function calculateDrag(t){var e=t.position[1]+t.elementMarginTop,i=t.position[0]+t.elementMarginLeft,s=t.elementPosition.left/t.scale,n=t.elementPosition.top/t.scale,a=s+t.elementWidth,o=n+t.elementHeight,h=t.contentPosition.left/t.scale,l=t.contentPosition.top/t.scale,c=t.lastPosition[1]>t.position[1],r=l+e,p=c&&t.fakeContentPosition.top+r<=t.edgeDistance,d=c&&l+e<=t.scrollTop/t.scale+t.edgeDistance,f=t.lastPosition[1]<t.position[1],g=t.fakeContentPosition.top+t.fakeContentHeight-l-o,u=f&&t.edgeDistance>=g,w=f&&t.scrollTop/t.scale+t.wrapperHeight/t.scale-(t.position[1]+l+t.elementHeight)-t.elementMarginTop<t.edgeDistance,D=t.lastPosition[0]>t.position[0],m=h+i,C=D&&t.fakeContentPosition.left+m<=t.edgeDistance,M=D&&h+i<=t.scrollLeft/t.scale+t.edgeDistance,T=t.lastPosition[0]<t.position[0],k=t.fakeContentPosition.left+t.fakeContentWidth-h-a;return{adjustTop:p,scrollToTop:d,adjustBottom:u,scrollToBottom:w,adjustLeft:C,scrollToLeft:M,leftDistance:m,adjustRight:T&&t.edgeDistance>=k,scrollToRight:T&&t.scrollLeft/t.scale+t.wrapperWidth/t.scale-(t.position[0]+h+t.elementWidth)-t.elementMarginLeft<t.edgeDistance}}"undefined"!=typeof module&&null!=module.exports&&(exports.calculateDrag=calculateDrag),function(t){"use strict";var e=function(t){this.defaultData={wrapper:".wrapper",fakeContent:".scroll-fake-content",content:".content",throttleMs:200,edgeDistance:100,scrollStep:100,fakeContentSize:null,scale:1,lastPosition:[0,0],getMaxTop:function(){return 1e4},getMaxLeft:function(){return 1e4},getMaxRight:function(){return 1e4},getMaxBottom:function(){return 1e4}},this.init(t)};e.prototype.centerContent=function(){var t,e,i=(t=this.$fakeContent,{x:((e=this.fakeContentSize)?e.width:t.width())/2,y:(e?e.height:t.height())/2}),s=this.contentSize?this.contentSize.width:this.$content.width(),n=this.contentSize?this.contentSize.height:this.$content.height(),a=i.x-s/2,o=i.y-n/2;this.fakeContentSize&&this.$fakeContent.css({width:this.fakeContentSize.width,height:this.fakeContentSize.height}),this.$content.css({left:a,top:o,width:s,height:n})},e.prototype.handleDrag=function(e,i){var s=(new Date).getTime();if(!(s-this.lastCall<this.throttleMs)){var n=this.isBody?t(window).width():this.$wrapper.width(),a=this.isBody?t(window).height():this.$wrapper.height(),o=this.$fakeContent.position(),h=this.$fakeContent.width(),l=this.$fakeContent.height(),c=t(i).width(),r=t(i).height(),p=t(i).position(),d=this.isBody?window:this.wrapper,f=Math.max(d.scrollLeft||d.scrollX),g=Math.max(d.scrollTop||d.scrollY),u=this.$content.position(),w=this.$content.width(),D=this.$content.height(),m=calculateDrag({position:e,lastPosition:this.lastPosition,scale:this.scale,edgeDistance:this.edgeDistance,scrollLeft:f,scrollTop:g,wrapperWidth:n,wrapperHeight:a,contentPosition:u,contentWidth:w,contentHeight:D,fakeContentPosition:o,fakeContentWidth:h,fakeContentHeight:l,elementPosition:p,elementHeight:r,elementWidth:c,elementMarginTop:this.elementMarginTop,elementMarginLeft:this.elementMarginLeft});if(this.lastPosition=e||[0,0],this.lastCall=s,m.adjustTop){var C,M=this.$fakeContent.height();this.$fakeContent.height(M+this.edgeDistance/this.scale),this.$content.css({top:this.$content.position().top/this.scale+this.edgeDistance/this.scale}),C=this.elementMarginTop-this.edgeDistance/this.scale,t(i).css({marginTop:C}),this.elementMarginTop=C}if(m.scrollToTop&&d.scrollTo(f,g-this.scrollStep+(m.adjustTop?this.edgeDistance:0)),m.adjustLeft){var T,k=this.$fakeContent.width();this.$fakeContent.width(k+this.edgeDistance/this.scale),this.$content.css({left:this.$content.position().left/this.scale+this.edgeDistance/this.scale}),T=this.elementMarginLeft-this.edgeDistance/this.scale,t(i).css({marginLeft:T}),this.elementMarginLeft=T}m.scrollToLeft&&d.scrollTo(f-(this.scrollStep+(m.adjustLeft?this.edgeDistance:0)),g),m.adjustRight&&this.$fakeContent.width(this.$fakeContent.width()+2*this.edgeDistance),m.scrollToRight&&d.scrollTo(f+this.scrollStep,g),m.adjustBottom&&this.$fakeContent.height(this.$fakeContent.height()+this.edgeDistance),m.scrollToBottom&&d.scrollTo(f,g+this.scrollStep)}},e.prototype.update=function(t){this.scale=t.scale||this.scale},e.prototype.handleDrop=function(e){var i=t(e),s=i.position(),n=s.top+this.elementMarginTop,a=s.left+this.elementMarginLeft,o=this.isBody?window:this.wrapper,h=Math.max(o.scrollLeft||o.scrollX),l=Math.max(o.scrollTop||o.scrollY);i.css({top:n,left:a,marginTop:0,marginLeft:0}),this.elementMarginTop=0,this.elementMarginLeft=0,this.onSpaceChange({contentSize:this.$content.size(),fakeContentSize:this.$fakeContent.size(),wrapperSize:this.$wrapper.size(),scale:this.scale,scroll:{left:h,top:l}})},e.prototype.init=function(e){var i,s;return this.data=e||this.defaultData,this.$wrapper=t(this.data.wrapper||this.defaultData.wrapper),this.wrapper=this.$wrapper[0],this.isBody="BODY"===this.wrapper.tagName,this.$fakeContent=t(this.data.fakeContent||this.defaultData.fakeContent),this.$content=t(this.data.content||this.defaultData.content),this.lastScrollTop=this.wrapper.scrollTop,this.lastScrollLeft=this.wrapper.scrollLeft,this.edgeDistance=this.data.edgeDistance||this.defaultData.edgeDistance,this.scrollStep=this.data.scrollStep||this.defaultData.scrollStep,this.throttleMs=this.data.throttleMs||this.defaultData.throttleMs,this.getMaxTop=this.data.getMaxTop||this.defaultData.getMaxTop,this.getMaxLeft=this.data.getMaxLeft||this.defaultData.getMaxLeft,this.getMaxRight=this.data.getMaxRight||this.defaultData.getMaxRight,this.getMaxBottom=this.data.getMaxBottom||this.defaultData.getMaxBottom,this.fakeContentSize=this.data.fakeContentSize||this.defaultData.fakeContentSize,this.contentSize=this.data.contentSize||this.defaultData.contentSize,this.scale=this.data.scale||this.defaultData.scale,this.onSpaceChange="function"==typeof this.data.onSpaceChange?this.data.onSpaceChange:function(){},this.elementMarginTop=0,this.elementMarginLeft=0,this.centerContent(),this.centers=(i=this.wrapper,s="BODY"===i.tagName,{x:i.scrollWidth/2-t(s?window:i).width()/2,y:i.scrollHeight/2-t(s?window:i).height()/2}),this.lastCenters=this.centers,this.lastPosition=[0,0],this.lastCall=(new Date).getTime(),(this.isBody?document.documentElement:this.wrapper).scrollTo(this.lastCenters.x,this.lastCenters.y),this},window.InfiniteSpace=e}(jQuery);